clear all
L=1e9;
d=40;
%n_clad=1.4442;
n0=1.4442;
delta1=0.0036;
delta2=-0.005;
%n_core=n_clad*(1+delta1);%1.4626;%core
n1=n0*(1+delta1);
ntr=n0*(1+delta2);
r1=3.85;
r2=9;
r3=14.75;
w=4;
R=2e5;
wavelength=1.5:0.01:1.64;
k=2*pi./wavelength;
V1=n1.*k.*r1*(2*delta1)^0.5;
W1=1.1428.*V1-0.996;
U1=(V1.^2-W1.^2).^0.5;
beta1=((n0.*k).^2+(W1./r1).^2).^0.5;
W2=r1.*(beta1.^2-(ntr.*k).^2).^0.5;
j1=besselj(1,U1);
k1=besselk(1,W1);
k2=besselk(1,r2/r1.*W1);
k3=besselk(1,r3/r1.*W2);
k4=besselk(1,r2/r1.*W2);
k5=besselk(1,r3/r1.*W1);
X=j1.*k2.*k3./k1./k4./k5;
P1=(d-r3)/r1.*W1;
P2=(d-r3)/r1.*W2;
Y1=(d-r2)/r1.*W2;
Y2=(d-r2)/r1.*W1;
syms r
j0=besselj(0,r/r1.*U1);
i0=besseli(0,(W1./r1-(P2-P1+Y2-Y1)./(d-r)).*r);
f=j0.*i0.*exp((P2-P1+Y2-Y1)*d/(d-r)).*r;
A=(n1.^2-n0.^2).*k.*W1.*U1.*(pi*r1./(2*W1*d)).^0.5.*exp(-d.*W1/r1).*X;
B=n1*(r1.^2).*(V1.^2).*(j1.^2);
C=int(f,r,0,r1);
MCC12=A./B.*C;
h12=2*MCC12.^2*R./(beta1.*d);
xt=tanh(h12.*L);
XTdB=10.*log10(xt);
figure(2)
plot(wavelength,XTdB,'*-')
xlabel('≤®≥§(¶Ãm)','FontSize',15)
ylabel('¥Æ»≈£®dB£©','FontSize',15)
%title('—ÿ≤®≥§…®√Ëµƒ¥Æ»≈')
text(1.3,0,' \leftarrow zero(1.304¶Ãm)','FontSize',15)
set(gca,'FontSize',15)
